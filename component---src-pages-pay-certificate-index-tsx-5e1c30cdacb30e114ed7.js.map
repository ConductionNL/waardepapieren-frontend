{"version":3,"file":"component---src-pages-pay-certificate-index-tsx-5e1c30cdacb30e114ed7.js","mappings":"qNAMe,SAASA,IACtB,MAA8BC,EAAAA,SAAe,MAAtCC,EAAP,KAAgBC,EAAhB,KACAF,EAAAA,WAAgB,WACQ,oBAAXG,QAAsC,OAAZF,EACnCC,EAAW,CACTE,OAAQD,OAAOE,kBAGbC,EAAAA,EAAAA,OAAkC,oBAAXH,SAGE,IAFPA,OAAOI,SAASC,OAEpBC,OACdC,EACEC,KAAKC,MAAMT,OAAOU,eAAeC,QAAQ,aAG3CC,OAIL,CAACd,IAEJ,MAA8BD,EAAAA,SAAe,MAAtCgB,EAAP,KAAgBN,EAAhB,KACA,EAA8BV,EAAAA,SAAe,MAAtCiB,EAAP,KAAgBC,EAAhB,KAEMH,EAAgB,WACpBG,GAAW,GACX,IAAMF,EAAUL,KAAKC,MACnBT,OAAOU,eAAeC,QAAQ,YAGhC,GAAsB,oBAAXX,OAAwB,CACjC,IAAMgB,EAAchB,OAAOI,SAASC,OAE9BY,EADY,IAAIC,gBAAgBF,GACZG,IAAI,WAE1BN,EAAQI,UAAYA,IACtBG,EAAAA,EAAAA,IAAS,KAGXC,MACKvB,EAAQG,OADR,8BAC4CY,EAAQS,GADpD,eACqEN,EACxE,CACEO,YAAa,UACbC,QAAS,CACP,eAAgB,sBAInBC,MAAK,SAACC,GAAD,OAAcA,EAASC,UAC5BF,MAAK,SAACG,IACLR,EAAAA,EAAAA,IAAS,UAKXS,EAAa,WACjBC,QAAQC,IAAIlB,GACU,oBAAXb,SACTA,OAAOU,eAAesB,WAAW,YACjCZ,EAAAA,EAAAA,IAAS,OAIb,OACE,gCACE,2BACE,gBAAC,IAAD,CACEa,MAAO,UACPC,WAAY,WACV,OACE,gCACe,OAAZpB,GACC,0BAAQqB,QAASN,EAAYO,UAAU,kBAAvC,WAORC,SAAU,WACR,OACE,gCACe,OAAZvB,GACC,gCACE,uBAAKsB,UAAU,eACb,uBAAKA,UAAU,iBAAiBE,KAAK,UACnC,wBAAMF,UAAU,WAAhB,iBAKK,OAAZvB,GAAgC,OAAZC,GACnB,wBAAMyB,OAAO,OAAOC,OAAQ3B,EAAQ4B,aAClC,uBAAKL,UAAU,OACb,uBAAKA,UAAU,qBACb,sBAAIA,UAAU,kDACZ,+CAA+B,IAC9BvB,EAAQ6B,KAAKC,WAAW,IAAK,OAGlC,uBAAKP,UAAU,qBACb,sBAAIA,UAAU,kDACZ,uCADF,MAC4BvB,EAAQ+B,MAAQ,IAD5C,OAIF,uBAAKR,UAAU,0BACb,0BAAQA,UAAW,kBAAnB,aAGHS,OAAOC,QAAQjC,EAAQkC,eAAeC,KACrC,YAAmB,IAAjBC,EAAgB,KAAXC,EAAW,KAChB,OACE,yBACED,IAAKA,EACLP,KAAK,SACLS,KAAMF,EACNC,MAAOA,cCtHnC,IAmDA,EAnDkB,WAChBrD,EAAAA,WAAgB,WACQ,oBAAXG,QACTD,EAAW,CACTqD,QAASpD,OAAOqD,gBAChBC,YAAatD,OAAOuD,wBAGvB,IACH,MAA8B1D,EAAAA,SAAe,CAC3CuD,QAAS,GACTE,YAAa,KAFRxD,EAAP,KAAgBC,EAAhB,KAIA,OACE,gBAAC,IAAD,KACE,4BACE,+CACA,uBAAKqC,UAAW,qBACbjC,EAAAA,EAAAA,MACC,gCACE,gBAACP,EAAD,OAGF,gCACE,sBAAIwC,UAAU,kDAAd,6BAGA,sBAAIA,UAAU,kDAAd,6CAGA,uBAAKA,UAAW,QACd,qBACEA,UAAW,eACXoB,KACE1D,EAAQsD,QACR,0BACAtD,EAAQwD,YACR,gBAGF,0BAAQlB,UAAW,kBAAnB","sources":["webpack://pwa/./src/components/waardepapieren/certificates.tsx","webpack://pwa/./src/pages/pay-certificate/index.tsx"],"sourcesContent":["import Card from \"@conductionnl/nl-design-system/lib/Card/src/card\";\nimport { Link } from \"gatsby\";\nimport * as React from \"react\";\nimport { isLoggedIn } from \"../../services/auth\";\nimport { navigate } from \"gatsby-link\";\n\nexport default function Certificates() {\n  const [context, setContext] = React.useState(null);\n  React.useEffect(() => {\n    if (typeof window !== \"undefined\" && context === null) {\n      setContext({\n        apiUrl: window.GATSBY_API_URL,\n      });\n    } else {\n      if (isLoggedIn() && typeof window !== \"undefined\") {\n        const queryString = window.location.search;\n\n        if (queryString.length === 0) {\n          setPayment(\n            JSON.parse(window.sessionStorage.getItem(\"payment\") as string)\n          );\n        } else {\n          handlePayment();\n        }\n      }\n    }\n  }, [context]);\n\n  const [payment, setPayment] = React.useState(null);\n  const [loading, setLoading] = React.useState(null);\n\n  const handlePayment = () => {\n    setLoading(true);\n    const payment = JSON.parse(\n      window.sessionStorage.getItem(\"payment\") as string\n    );\n\n    if (typeof window !== \"undefined\") {\n      const queryString = window.location.search;\n      const urlParams = new URLSearchParams(queryString);\n      const orderId = urlParams.get(\"orderID\");\n\n      if (payment.orderId !== orderId) {\n        navigate(\"/\");\n      }\n\n      fetch(\n        `${context.apiUrl}/gateways/service/payments/${payment.id}/certificate${queryString}`,\n        {\n          credentials: \"include\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n        }\n      )\n        .then((response) => response.json())\n        .then((data) => {\n          navigate(\"/\");\n        });\n    }\n  };\n\n  const handleBack = () => {\n    console.log(payment);\n    if (typeof window !== \"undefined\") {\n      window.sessionStorage.removeItem(\"payment\");\n      navigate(\"/\");\n    }\n  };\n\n  return (\n    <>\n      <div>\n        <Card\n          title={\"Betalen\"}\n          cardHeader={function () {\n            return (\n              <>\n                {loading === null && (\n                  <button onClick={handleBack} className=\"utrecht-button\">\n                    Terug\n                  </button>\n                )}\n              </>\n            );\n          }}\n          cardBody={function () {\n            return (\n              <>\n                {loading !== null && (\n                  <>\n                    <div className=\"text-center\">\n                      <div className=\"spinner-border\" role=\"status\">\n                        <span className=\"sr-only\">Loading...</span>\n                      </div>\n                    </div>\n                  </>\n                )}\n                {payment !== null && loading === null && (\n                  <form method=\"POST\" action={payment.redirectUrl}>\n                    <div className=\"row\">\n                      <div className=\"col-12 text-start\">\n                        <h4 className=\"utrecht-heading-4 utrecht-heading-4--distanced\">\n                          <strong>Waardepapier:</strong>{\" \"}\n                          {payment.type.replaceAll(\"_\", \" \")}\n                        </h4>\n                      </div>\n                      <div className=\"col-12 text-start\">\n                        <h4 className=\"utrecht-heading-4 utrecht-heading-4--distanced\">\n                          <strong>Kost:</strong> â‚¬ {payment.price / 100},-\n                        </h4>\n                      </div>\n                      <div className=\"col-12 text-start mt-4\">\n                        <button className={\"utrecht-button\"}>Betalen</button>\n                      </div>\n                    </div>\n                    {Object.entries(payment.configuration).map(\n                      ([key, value]) => {\n                        return (\n                          <input\n                            key={key}\n                            type=\"hidden\"\n                            name={key}\n                            value={value}\n                          />\n                        );\n                      }\n                    )}\n                  </form>\n                )}\n              </>\n            );\n          }}\n        />\n      </div>\n    </>\n  );\n}\n","import * as React from \"react\";\nimport Layout from \"../../components/common/layout\";\nimport Certificates from \"../../components/waardepapieren/certificates\";\nimport { isLoggedIn } from \"../../services/auth\";\n\nconst IndexPage = () => {\n  React.useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      setContext({\n        baseUrl: window.GATSBY_BASE_URL,\n        frontendUrl: window.GATSBY_FRONTEND_URL,\n      });\n    }\n  }, []);\n  const [context, setContext] = React.useState({\n    baseUrl: \"\",\n    frontendUrl: \"\",\n  });\n  return (\n    <Layout>\n      <main>\n        <title>Waardepapieren</title>\n        <div className={\"text-center mt-4\"}>\n          {isLoggedIn() ? (\n            <>\n              <Certificates />\n            </>\n          ) : (\n            <>\n              <h1 className=\"utrecht-heading-1 utrecht-heading-1--distanced\">\n                Welkom bij Waardepapieren\n              </h1>\n              <h4 className=\"utrecht-heading-4 utrecht-heading-4--distanced\">\n                U dient ingelogd te zijn om door te gaan.\n              </h4>\n              <div className={\"mt-4\"}>\n                <a\n                  className={\"utrecht-link\"}\n                  href={\n                    context.baseUrl +\n                    \"/digid/login?returnUrl=\" +\n                    context.frontendUrl +\n                    \"/handleLogin\"\n                  }\n                >\n                  <button className={\"utrecht-button\"}>Inloggen</button>\n                </a>\n              </div>\n            </>\n          )}\n        </div>\n      </main>\n    </Layout>\n  );\n};\n\nexport default IndexPage;\n"],"names":["Certificates","React","context","setContext","window","apiUrl","GATSBY_API_URL","isLoggedIn","location","search","length","setPayment","JSON","parse","sessionStorage","getItem","handlePayment","payment","loading","setLoading","queryString","orderId","URLSearchParams","get","navigate","fetch","id","credentials","headers","then","response","json","data","handleBack","console","log","removeItem","title","cardHeader","onClick","className","cardBody","role","method","action","redirectUrl","type","replaceAll","price","Object","entries","configuration","map","key","value","name","baseUrl","GATSBY_BASE_URL","frontendUrl","GATSBY_FRONTEND_URL","href"],"sourceRoot":""}